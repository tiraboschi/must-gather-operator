---
apiVersion: batch/v1
kind: Job
metadata:
  name: example-mustgather
  namespace:
spec:
  template:
    spec:
      backoffLimit: 6
      containers:
        - command:
            - "/bin/bash"
            - "-c"
            - "/usr/local/bin/upload"
          env:
            - name: username
              valueFrom:
                secretKeyRef:
                  key: username
                  name: case-management-creds
            - name: password
              valueFrom:
                secretKeyRef:
                  key: password
                  name: case-management-creds
            - name: caseid
              value: '02527285'
            - name: must_gather_output
              value: "/must-gather"
            - name: must_gather_upload
              value: "/must-gather-upload"
          image: quay.io/redhat-cop/must-gather-operator:latest
          name: upload
          volumeMounts:
            - mountPath: "/must-gather"
              name: must-gather-output
            - mountPath: "/must-gather-upload"
              name: must-gather-upload
      initContainers:
        - command:
            - /usr/bin/gather
          image: quay.io/openshift/origin-must-gather:latest
          name: gather-0
          volumeMounts:
            - mountPath: "/must-gather"
              name: must-gather-output
      restartPolicy: OnFailure
      serviceAccountName: default
      volumes:
        - emptyDir: {}
          name: must-gather-output
        - emptyDir: {}
          name: must-gather-upload
